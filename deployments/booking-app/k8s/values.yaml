nginx:
  enabled: true

ingress-nginx:
  controller:
    service:
      type: LoadBalancer
      annotations:
        cloud.google.com/load-balancer-type: "External"
    ingressClassResource:
      name: nginx
      enabled: true
      default: true
    metrics:
      enabled: true
    resources:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: 500m
        memory: 1Gi

# Internal Ingress Nginx Controller
ingress-nginx-internal:
  enabled: true
  controller:
    service:
      type: LoadBalancer
      annotations:
        cloud.google.com/load-balancer-type: "Internal"
    ingressClassResource:
      name: nginx-internal
      enabled: true
      default: false
      controllerValue: k8s.io/ingress-nginx-internal
    admissionWebhooks:
      enabled: false
      patch:
        enabled: false
      certificate:
        enabled: false
      failurePolicy: Ignore
    metrics:
      enabled: true
    resources:
      requests:
        cpu: 2000m
        memory: 2Gi
      limits:
        cpu: 4000m
        memory: 4Gi

# MySQL
mysql:
  enabled: true
  image:
    repository: mysql
    tag: "8.0"
  storage:
    size: 10Gi
    storageClass: standard-rwo
  rootPassword: "root"
  database: "ticket_booking"
  username: "booking_user"
  password: "booking_pass"
  resources:
    requests:
      cpu: 2000m
      memory: 4Gi
    limits:
      cpu: 4000m
      memory: 8Gi

# Redis 설정
redis:
  enabled: true
  image:
    repository: redis
    tag: "7-alpine"
  resources:
    requests:
      cpu: 2000m
      memory: 8Gi
    limits:
      cpu: 4000m
      memory: 16Gi

# Booking Platform 설정
bookingPlatform:
  replicaCount: 5
  image:
    repository: asia-northeast3-docker.pkg.dev/gifted-slice-475903-c6/ticket-booking/booking-app
    tag: "latest"
    pullPolicy: Always

  service:
    type: ClusterIP
    port: 80
    targetPort: 8080

  resources:
    requests:
      cpu: "1000m"
      memory: "2Gi"
    limits:
      cpu: "2000m"
      memory: "3Gi"

  env:
    - name: JAVA_TOOL_OPTIONS
      value: "-Xmx2g -Xms1g -XX:+UseG1GC"
    - name: SPRING_PROFILES_ACTIVE
      value: "test"

  queuePartitionCount: 32

# External Ingress 설정
ingress:
  enabled: true
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts: [ ]
  tls: [ ]

# Internal Ingress 설정
internalIngress:
  enabled: true
  className: nginx-internal
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts: [ ]
  tls: [ ]

# Health check 설정
probes:
  enabled: true
  startup:
    httpGet:
      path: /actuator/health
      port: 8080
    initialDelaySeconds: 30
    periodSeconds: 10
    failureThreshold: 30
    timeoutSeconds: 5
  liveness:
    httpGet:
      path: /actuator/health
      port: 8080
    initialDelaySeconds: 60
    periodSeconds: 10
    failureThreshold: 3
    timeoutSeconds: 5
  readiness:
    httpGet:
      path: /actuator/health
      port: 8080
    initialDelaySeconds: 30
    periodSeconds: 10
    failureThreshold: 3
    timeoutSeconds: 5